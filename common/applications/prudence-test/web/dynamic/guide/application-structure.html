<%velocity #set($executable.cacheDuration=5000) #set($prefix = '../') %><%& '../fragments/header' %>

<h2>Application Structure</h2>

<p>Each application's subdirectory name under the
/applications/ directory is used as a default for many things. Under
that subdirectory is a straightforward structure, detailed below.</p>

<p>One of Prudence's strengths is how easy it is to deploy and
develop your applications. All you need to do is create a subdirectory
for each application with this structure. During development, your
changes will be picked up on-the-fly within configurable intervals.</p>

<h3>/web/dynamic/</h3>

<p>This is where you'll put your dynamic HTML files. By "dynamic" is
meant that they are generated on-demand, such that each request can
potentially produce a different result. Prudence has a powerful
framework for embedding programming language code into files, and for
supporting caching of results for performance, streaming of results, and
support for textual formats beyond HTML, such as XML, RSS, JSON, etc.
Later, we will <a href="../generating-html/">examine HTML generation in
depth</a>.</p>

<p>The names of the files and subdirectories under /web/dynamic/
attach to URLs, with simple intelligence to make it easy for you to
create sensible, pretty URL schemes. Prudence additionally
supports <a href="../routing/">much more powerful routing</a>.</p>

<h3>/web/static/</h3>

<p>This subdirectory works like a standard "static" web server.
Files put here are attached to URLs and accessible to clients as is.
Prudence uses non-blocking I/O for high performance, scalable delivery
of data to client. Like many web servers, MIME types for HTTP headers
are automatically assigned according to the filename extension. For
example. ".html" files will be sent as "application/html", and ".png"
files will be sent as "image/png". You can easily configure the basic
mapping table.</p>

<p>The static web subdirectory will likely just work for you as is.
Later, we'll delve into <a href="../static-web/">a few of its
configuration features</a>.</p>

<h3>/web/fragments/</h3>

This subdirectory is not technically used by Prudence, but it's customary
to put fragments included by /web/dynamic files here. Note that you can
include files from anywhere in your file system.

<h3>/resources/</h3>

<p>Whereas the /web/dynamic/ subdirectory has HTML files with embedded
programming language code, /resources/ is pure code. This is Prudence's
most powerful feature: files here are attached as REST resources,
capable of handling all HTTP verbs and responding with appropriate
representations in many different formats.</p>

<p>From the perspective of web development, consider that if
/web/dynamic/ lets you write HTML-based front ends for "thin" clients,
such as simple web browsers, /resources/ lets you handle "rich" clients,
such as AJAX, Flash and other dynamic platforms.</p>

<p>We'll delve into <a href="../resources/">resources</a> later.</p>

<h3>/libraries/</h3>

Like /web/fragments/, Prudence does not directly use this directory,
but it's customary to put your code here. Code here can be used by
/resources/ and by scriptlets in /web/dynamic/.

<h3>Default Routing</h3>

<p>By default, URLs will attach first to /web/dynamic/, then to
/web/static/, and finally to /resources/. Thus, identical URLs from
prior sections will hide those from latter sections. You can easily
change the order of attachment. Routing will be <a href="../routing/">covered
in depth</a> later.</p>

<h3>Application Setup</h3>

<p>The above directories may be all you need for your application.
Prudence will also pick up some more files in your application's
root subdirectory. Note that these are processed only during
Prudence initialization, so it must be restarted for changes to
take effect.</p>

<h4>settings</h4>

<p>Here you can override some of Prudence's defaults for your
application, such as the subdirectory structure detailed here,
the default URLs, include some distribution information, configure
the logging name, etc.</p>

<p>You can also add your own runtime settings for your code to use,
such as database usernames and passwords.</p>

<h4>routing</h4>

<p>The settings file gives you some control over the default URLs,
but here you can manipulate them extensively. Your routing tools
are very powerful, including redirection based on URL patterns,
regular expressions, and route scoring.</p>

<p>In particular, this is where you install URL patterns for
your resources. For example, you can attach /item/{id}/ to your
item resource, and have "id" automatically extracted from the URL.
</p>

<p>This is also where you can attach your own custom (non-Prudence)
resources to URLs. Actually, anything that's a "restlet" will do,
because Prudence uses <a href="http://restlet.org/">Restlet</a> for
its resource routing. More on integrating custom restlets
<a href="../non-prudence/">here</a>.</p>

<p>More on <a href="../routing/">routing</a> later.</p>

<h4>application</h4>

<p>Use this to install non-Prudence Restlet applications into
Prudence. 
By default, Prudence creates a basic Restlet application,
but you can override that creation in this file.
More on this topic <a href="../non-prudence/">here</a>.</p>

<h4>default</h4>

<p>You'll rarely need to do it, but you can also override Prudene's
default application bootstrap.</p>

<div class="tutorial">
<p>
Let's go ahead and create a subdirectory named "hello" under
/applications/. When you restart Prudence, you'll see it announce the
"hello" application as available under the /hello/ URL. We don't have
anything there quite yet, so you will get an error if you try to browse
to http://localhost:8080/hello/.</p>
</div>

<%& '../fragments/footer' %>
